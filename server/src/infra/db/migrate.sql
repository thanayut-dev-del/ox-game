CREATE TABLE IF NOT EXISTS users(id BIGINT PRIMARY KEY AUTO_INCREMENT,provider VARCHAR(32),provider_id VARCHAR(128) UNIQUE,email VARCHAR(255) UNIQUE,name VARCHAR(255),avatar TEXT,is_admin BOOLEAN DEFAULT FALSE,created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP);
CREATE TABLE IF NOT EXISTS stats(user_id BIGINT PRIMARY KEY,score INT NOT NULL DEFAULT 0,win_streak INT NOT NULL DEFAULT 0,best_streak INT NOT NULL DEFAULT 0,updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,FOREIGN KEY (user_id) REFERENCES users(id));
CREATE TABLE IF NOT EXISTS matches(id BIGINT PRIMARY KEY AUTO_INCREMENT,user_id BIGINT NOT NULL,result ENUM('WIN','LOSS','DRAW') NOT NULL,moves JSON,finished_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,FOREIGN KEY (user_id) REFERENCES users(id));
